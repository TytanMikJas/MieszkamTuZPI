import { Transform } from 'class-transformer';
import { SimpleBadRequest } from 'src/exceptions/simple-bad-request.exception';
import { ERROR_INVALID_LOCATION_TUPLE } from 'src/strings';

export function validate(value: string) {
  const parsedValue = value.split(',').map((v) => parseFloat(v));
  if (parsedValue.length !== 2 || parsedValue.some((v) => isNaN(v))) {
    throw new SimpleBadRequest(ERROR_INVALID_LOCATION_TUPLE);
  }
  return value;
}

<<<<<<< HEAD
/**
 * Validator, which validates a string of geo location tuple. Location tuple is a string of
 * two numbers separated by comma ex. 56.123, 56.678
 * @returns
 */
=======
>>>>>>> 7f54bd9 (c1)
export default function ValidateLocationTuple() {
  return Transform(({ value }) => validate(value));
}
